# Домашнее задание 2 по Pyspark

Основная задача - по данным постов в телеграм каналах предсказать количество просмотров этих постов. Поскольку мы изучаем Spark, акцент в задании - на подготовку фичей на кластере, а не на непосредственно тюнинге модели. Проверяться будет качество модели тоже, но достаточно будет преодолеть довольно простой бейзлайн.

## Данные

Вот тут лежит шаблон решения ссылка на шаблон (https://yadi.sk/d/GBQVSv4VpUdDEA). Там предлагается один из возможных путей решения, можно модифицировать его как угодно.

### Предоставляется 3 файла:
- трейн сет (с количеством просмотров)
- тест сет (без количества просмотров)
- метаданные каналов

Трейн и тест разбиты по времени. Как прочитать данные можно посмотреть в ноутбуке.

## Задание

1. Подсчитать фичи для модели, используя только Spark.
2. (Опционально) Фичи можно перевести в pandas и обучить свой любимый алгоритм локально.
3. Предсказать ими тест сет и побить бейзлайн по целевым метрикам.

## Метрики

Поскольку просмотры распределены экспоненциально, предсказывать будем странную величину log(post_views + 100). Вычисляются сразу 4 метрики, но они связаны между собой. Это:
- RMSPE - Root Mean Squared Percentage Error
- MAPE - Mean Absolute Percentage Error
- MAE - Mean Absolute Error
- RMSE - Root Mean Squared Error

## Сабмиты

Для проверки сабмитов используется специальный модуль. Как его использовать смотрите в ноутбуке. 

При импорте этого модуля у вас запросит имя пользователя и пароль - их мы вышлем всем лично.

Если формат предсказаний неправильный, вернутся ошибки с описанием. Если все хорошо, вернутся значения метрик.

### Ограничение на сабмиты:
- За день можно делать максимум 5 сабмитов.
- Для итогового сабмита нужно выставить флаг final=True для функции make_eval. Это сохраняет ваш сабмит для проверки, без этого задание считается не сделанным!

## Критерии

Для получения оценки > 0 нужно прислать ноутбук в виде .ipynb файла, который можно выполнить через Run All, и который в результате сделает сабмит. Прислать нужно на почту email.

Для получения положительной оценки (> 3) нужно сделать сабмит с метриками лучше, чем у бейзлайна:

BASELINE = {
  'mape': 15.707128974856676,
  'mean_absolute_error': 1.219070382113261,
  'mean_squared_error': 2.4324378881170055,
  'rmse': 1.5596274837655963,
  'rmspe': 23.50065988751091
}


Выполнение этого условия дает вам оценку 5. Остальные баллы можно получить за следующие пункты:

- 1 балл за фичу, использующую метаданные каналов (макс 1 балл).
- 2 балла за фичу, использующую текстовые поля (макс 2 балла).
- 1 балл за фичу, использующую window aggregation, до 2 штук, различающихся по смыслу и реализации. Фичи которые можно альтернативно подсчитать group by и join не засчитываются (макс 2 балла).
- -1 балл за грязный код и -1 балл за отсутствие комментариев.
- -10 баллов за списывание (обоим участникам) (макс -10 баллов).

Все фичи должны быть осмысленными для задачи. Поля исходных данных и их простейшие преобразования (математические выражения для числовых, количество символов/слов для текстовых и т.д.) не засчитываются. Но при этом вы можете их добавлять чтобы улучшить модель.
